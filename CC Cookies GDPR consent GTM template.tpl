___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "CC Cookies GDPR consent",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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YII\u003d"
  },
  "description": "Tag ustawia consent mode na podstawie zgód z ciastka. Domyślne kategorie: analytics_storage, ad_storage, ad_user_data, ad_personalization, functionality_storage, personalization_storage, security.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "CHECKBOX",
    "name": "ads_data_redaction",
    "checkboxText": "Redact Ads Data",
    "simpleValueType": true,
    "help": "Gdy ad_storage jest wyłączone, nowe pliki cookie nie zostaną ustawione do celów reklamowych. Ponadto pliki cookie stron trzecich ustawione wcześniej na google.com i doubleclick.net nie będą używane. Dane wysyłane do Google nadal będą zawierać pełny adres URL strony, w tym wszelkie informacje o kliknięciu reklamy w parametrach adresu URL. Aby dalej przetwarzać dane reklam, gdy ad_storage jest wyłączone, włącz ads_data_redaction."
  },
  {
    "type": "CHECKBOX",
    "name": "url_passthrough",
    "checkboxText": "url_passthrough",
    "simpleValueType": true,
    "help": "Sprawdza adres URL pod kątem parametrów reklamowych (gclid, dclid, gclsrc, _gl) i dodaje je do wszystkich wewnętrznych adresów URL linków."
  },
  {
    "type": "PARAM_TABLE",
    "name": "defaultSettings",
    "displayName": "Ustawienia",
    "paramTableColumns": [
      {
        "param": {
          "type": "TEXT",
          "name": "region",
          "displayName": "Region (pozostaw puste, aby zastosować do wszystkich regionów)",
          "simpleValueType": true,
          "help": "Możesz dodać wiele deklaracji dla różnych regionów (kod regionu w formie ISO 3166-2, np.: https://en.wikipedia.org/wiki/ISO_3166-2)"
        },
        "isUnique": true
      },
      {
        "param": {
          "type": "TEXT",
          "name": "granted",
          "displayName": "Aktywne zgody (rozdzielone przecinkami)",
          "simpleValueType": true,
          "defaultValue": "security_storage",
          "help": "Dostępne zgody: analytics_storage, ad_storage, functionality_storage, personalization_storage, security_storage."
        },
        "isUnique": false
      },
      {
        "param": {
          "type": "TEXT",
          "name": "denied",
          "displayName": "Wyłączone zgody (rozdzielone przecinkami)",
          "simpleValueType": true,
          "defaultValue": "analytics_storage,ad_storage,ad_user_data,ad_personalization,personalization_storage,functionality_storage",
          "help": "Dostępne zgody: analytics_storage, ad_storage, ad_user_data, ad_personalization, functionality_storage, personalization_storage, security_storage."
        },
        "isUnique": false
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "debug_mode",
    "checkboxText": "Debug mode",
    "simpleValueType": true,
    "help": "Debug mode log events to browser console"
  },
  {
    "type": "TEXT",
    "name": "wait_for_update",
    "displayName": "Wait for update",
    "simpleValueType": true,
    "defaultValue": 500,
    "help": "Set wait for update time (ms). Default: 500ms."
  },
  {
    "type": "TEXT",
    "name": "cookieName",
    "displayName": "Cookie name",
    "simpleValueType": true,
    "defaultValue": "cc_cookie",
    "help": "Enter the name of cookie you want to read from"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const queryPermission = require('queryPermission');
const getCookieValues = require('getCookieValues');
const cookieName = data.cookieName ? data.cookieName : 'cc_cookie';
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const callInWindow = require('callInWindow');
const gtagSet = require('gtagSet');
const JSON = require('JSON');
var defaultData = {};
const debugMode = data.debug_mode || false;
const log = require('logToConsole');
const wait_for_update = data.wait_for_update || 500;

/*
 * Splits the input string using comma as a delimiter, returning an array of
 * strings
 */
const splitInput = (input) => {
  return input.split(',')
      .map(entry => entry.trim())
      .filter(entry => entry.length !== 0);
};

/**
 * Processes a row of input from the default settings table, returning an object
 * which can be passed as an argument to setDefaultConsentState
 */
const parseCommandData = (settings) => {
  const regions = splitInput(settings.region);
  const granted = splitInput(settings.granted);
  const denied = splitInput(settings.denied);
  const commandData = {};
  if (regions.length > 0) {
    commandData.region = regions;
  }
  granted.forEach(entry => {
    commandData[entry] = 'granted';
  });
  denied.forEach(entry => {
    commandData[entry] = 'denied';
  });

  return commandData;
};

/**
 * Called when consent changes. Assumes that consent object contains keys which
 * directly correspond to Google consent types.
 */
const onUserConsent = (consent) => {
  
  const consentModeStates = {
    ad_storage: 'denied',
    analytics_storage: 'denied',
    ad_user_data: 'denied',
    ad_personalization: 'denied',
    personalization_storage: 'denied',
    functionality_storage: 'denied',
    security_storage: 'granted'
  };
  
  consent.forEach(function callback(value, index) {
    if ( value !== 'necessary' ) {
      consentModeStates[value] = 'granted';
    }
  });
  
  updateConsentState(consentModeStates);
  
  if(debugMode) {
     log('updateConsentState:', consentModeStates);
  }
};

/**
 * Executes the default command and sets up the consent
 * update callback
 */
const main = (data) => {
  
  if (typeof data.defaultSettings !== 'undefined' ) {
    data.defaultSettings.forEach(settings => {
      defaultData = parseCommandData(settings);
      defaultData.wait_for_update = wait_for_update;
      setDefaultConsentState(defaultData);
      
       if(debugMode) {
         log('setDefaultConsentState:', defaultData);
       }
    });
   }
  
      callInWindow('AddCookieSetCallback', onUserConsent);
        
      if(debugMode) {
       log("callInWindow('AddCookieSetCallback', onUserConsent)");
      }
  
    //Check if script can read cookies
    if (queryPermission('get_cookies', cookieName)) {
      //get the cookie content and parse to object
      const cookieValue = JSON.parse(getCookieValues(cookieName));
      
      //check if we have any cookie data
      if (typeof cookieValue.categories !== 'undefined') {
        //update Consent State with array of categories
        onUserConsent(cookieValue.categories);
        
        if(debugMode) {
         log('Consent updated with cookie values array: ', cookieValue.categories);
        }
      } 
    }

  gtagSet({
    url_passthrough: data.url_passthrough || false,
    ads_data_redaction: data.ads_data_redaction || false
  });
};
main(data);
data.gtmOnSuccess();


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ads_data_redaction"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "wait_for_update"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "AddCookieSetCallback"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Quick Test
  code: runCode();
setup: ''


___NOTES___

Created on 21.06.2022, 09:15:27


